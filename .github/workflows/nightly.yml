name: Nightly update
on:
  schedule:
    - cron: "0 10 5 * *"

jobs:
  kind:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Checksum developer.statuspage.io
        run: |
          resp=$(curl -sL https://developer.statuspage.io/ | md5sum | cut -d ' ' -f 1)
          local=$(< developer_statuspage_io_md5sums)
          if [ "$local" != "$resp" ]; then
            echo "$resp" > developer_statuspage_io_md5sums
          fi

      - name: Create Pull Request
        id: cpr
        uses: peter-evans/create-pull-request@v3.9.1
        with:
          commit-message: "build(deps): bumphttps://developer.statuspage.io/ from v1 to ?"
          branch: dependencies/api/statuspage
          title: 'build(deps): bump https://developer.statuspage.io/ from v1 to ?'
          body: |
            Bump https://developer.statuspage.io/ from v1 to ?
            Auto-generated by [create-pull-request][1]
          labels: |
            dependencies
            openapi

      - name: Check outputs
        run: |
          echo "Pull Request Number - ${{ steps.cpr.outputs.pull-request-number }}"
          echo "Pull Request URL - ${{ steps.cpr.outputs.pull-request-url }}"
